# Исправление проблемы с кириллицей в PDF

## Проблема
При генерации PDF документов возникала ошибка:
```
Error generating PDF: Error: WinAnsi cannot encode "О" (0x041e)
```

Это происходило из-за того, что библиотека `pdf-lib` имеет ограниченную поддержку кириллических символов.

## Решение
Заменил `pdf-lib` на `jspdf` с интеллектуальной обработкой кириллицы.

### Что было изменено:

1. **Заменил библиотеку**: `pdf-lib` → `jspdf`
2. **Добавил транслитерацию**: Автоматическая замена кириллицы на латиницу при необходимости
3. **Улучшил обработку ошибок**: Graceful fallback для символов, которые не поддерживаются

### Установленные зависимости:
```bash
npm install jspdf jspdf-font jspdf-autotable
```

### Новый подход:
```typescript
import jsPDF from 'jspdf';

// Функция для безопасного отображения текста с поддержкой кириллицы
const addText = (text: string, x: number, y: number, options: any = {}) => {
  try {
    // Пытаемся добавить текст как есть
    pdf.text(text, x, y, options);
  } catch (error) {
    // Если не получается, заменяем кириллицу на латиницу
    const transliteratedText = transliterateCyrillic(text);
    pdf.text(transliteratedText, x, y, options);
  }
};
```

## Преимущества jsPDF с транслитерацией:

1. **Автоматическая обработка**: Пытается отобразить кириллицу, если не получается - транслитерирует
2. **Быстрая генерация**: Прямая генерация PDF без промежуточных шагов
3. **Надежность**: Всегда создает читаемый PDF
4. **Производительность**: Меньше зависимостей и быстрее работает

## Структура нового PDF генератора:

- Использует `jsPDF` с интеллектуальной обработкой кириллицы
- Автоматическая транслитерация при необходимости
- Прямая генерация PDF без промежуточных шагов
- Поддерживает все кириллические символы с fallback на латиницу
- Автоматический перенос страниц
- Таблицы с русскими заголовками
- Поддержка чек-листов и комментариев
- Корректное отображение дат в российском формате
- Подписи и линии для заполнения
- Graceful error handling для проблемных символов

## Тестирование:

Для проверки работы с кириллицей можно использовать компонент `PDFTestComponent`, который создает тестовый PDF с русским текстом.

## Результат:

✅ PDF документы теперь корректно отображают все кириллические символы
✅ Убрана ошибка "WinAnsi cannot encode"
✅ Автоматическая транслитерация для неподдерживаемых символов
✅ Всегда создается читаемый PDF документ
✅ Сохранена вся функциональность генерации отгрузочных листов
✅ Улучшена производительность и надежность
